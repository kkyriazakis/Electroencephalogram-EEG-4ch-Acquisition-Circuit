import numpy as np
import math
from array import array
import collections
from sklearn import metrics
from sklearn.metrics import confusion_matrix, mean_squared_error, r2_score, mean_absolute_error
import statistics
from sklearn import preprocessing
import matplotlib.pyplot as plt
from scipy.io import loadmat
from scipy import fftpack

Fs = 1/2.3
t = np.arange(0, 338, 1/Fs)

ts = np.array([0.495129229869615,	-1.78859933992712,	-2.64797695590499,	-1.37366441996072,	0.279906821940612,	-1.96713820277326,	0.0118784252649265,	0.281782621966799,	-0.318422241773513,	1.07725185842184,	2.24858758399518,	-0.164044324471338,	1.16679403745378,	0.560842267370197,	0.677169448194758,	1.26106075258736,	1.60171918603959,	0.504955061308309,	-1.41394470093674,	-0.454150329174403,	-0.799300092631149,	-0.809162977265149,	-0.487856658831687,	-0.0271821403395230,	-0.756512442300486,	0.480249274000145,	0.679741441290688,	1.67277343801930,	1.96015605071831,	-0.539014646429537,	-0.0731993289542888,	-0.606727913841901,	0.527584570345389,	0.503806034678839,	2.22269528194780,	1.39541609748412,	1.05637294273788,	-0.301509928581597,	-0.464444948608606,	0.509548079068189,	-3.24395320284319,	-1.17700034761997,	-0.562835617628006,	-0.690369796969305,	1.01134052806731,	-0.259268781777748,	0.985510800686737,	-0.743966292469460,	0.339944155731461,	1.82564958603762,	-0.199508570705161,	-0.471148019748456,	-2.32973391077969,	-0.667206937862403,	-0.897907841293499,	0.834439245733563,	-0.901881333176412,	-0.787292154823862,	-1.51375511567564,	-0.151373415864197,	-0.548553782704873,	-0.183672177406177,	0.00269684599531826,	-0.545691934283728,	-1.08804652884273,	1.37662168017045,	0.257085275460696,	0.505019469756128,	-0.785229432467906,	0.482409562161208,	-0.265807142598482,	1.19021956324239,	0.375930821834744,	-0.837375401774389,	0.705653183580594,	-1.13639028574078,	2.26869261055187,	0.174197116360635,	-1.59357760402876,	-0.865413319570939,	-1.78614413542161,	-0.630818507107428,	0.389251822581429,	0.290243311085217,	-0.00252628055946839,	0.594625795421719,	-0.0819917582545981,	0.399187060965778,	0.0989938087917767,	1.62211485336399,	2.25644559205694,	0.738303454437516,	0.530180163499786,	1.08999887056399,	1.59610322356156,	-0.0485023740875538,	0.413253389294690,	0.388123875237701,	0.462507027221957,	0.509218451791505,	0.110187715518495,	0.793466258576426,	-1.53329905392565,	0.343073128166350,	0.324299758763998,	-0.722019894448993,	-0.184517825251605,	-0.231927266935023,	-0.347037201230660,	-0.905089282610845,	-0.919587187785962,	1.47009863720925,	-0.466887296091340,	-0.488251012627942,	-0.450964108151735,	0.127729891919305,	0.248652328906652,	0.513858893616796,	1.12349831185690,	0.679236234079622,	-0.00441496790097778,	1.17274099686439,	0.878517539272644,	0.776122657399386,	0.0435181659389070,	-0.459045534572071,	0.403450514197823,	-0.245607853206260,	-1.34433779226942,	-1.44435707304333,	-0.169082723824192,	-0.403166863435517,	-1.98235360100671,	-2.08616146470631,	-1.47575449821831,	-0.461566882855637,	0.637912777291058,	-1.02342299419713,	0.604531858836935,	1.27096076506616,	-0.811566296045711,	-1.04991011638501,	0.171027800743376,	1.39066465835441,	-0.696246975332380,	1.71463912816732,	0.208849496349177])

# plt.series = ts
# plt.plot(ts)
# plt.show()

y_fft = fftpack.fft(ts)
n = np.size(t)
fr = Fs/2 * np.linspace(0, 1, math.floor(n/2))
ts_m = 2/n * abs(y_fft[0:np.size(fr)])
fig, ax = plt.subplots(nrows=1, ncols=2, figsize=(15, 5))
ax[0].plot(t, ts)    # plot time series
ax[1].plot(fr, ts_m) # plot freq domain
plt.show()


